/* DENORMALIZED TABLE */
DROP TABLE REGULAR_BOOKING_DNORM;
DROP TABLE CLIENTS_DNORM;
DROP TABLE CARS_DNORM;
DROP TABLE DRIVER_REVENUE_DNORM;
DROP TABLE BOOKING_DNORM;
DROP TABLE EMPLOYEE_INCIDENTS_DNORM;
DROP TABLE SHIFT_DNORM;
DROP TABLE EMPLOYEE_DNORM;

CREATE TABLE BOOKING_DNORM (
BOOKINGID CHAR(9) NOT NULL, 
OPERATORID CHAR(9),
DRIVERID CHAR(9),
REGBOOKID CHAR(9),
CLIENTID CHAR(9),
DATEBOOKED DATE,
PICKUPDATE DATE,
PICKUPADDRESS VARCHAR(255),
DROPOFFADDRESS VARCHAR(255),
NOOFPASSENGERS NUMBER(2),
CUSTOMERPHONENO CHAR(11),
PAYMENTMETHOD VARCHAR(10),
PAYMENTDATE DATE,
PAYEESFIRSTNAME VARCHAR(255),
PAYEESLASTNAME VARCHAR(255),
CARDNO VARCHAR(16),
EXPIRYDATE DATE,
CVV CHAR(3),
AMOUNTPAID NUMBER(8,2)
);
 
CREATE TABLE SHIFT_DNORM (
SHIFTID CHAR(9) NOT NULL,
EMPLOYEEID CHAR(9),
EMPFNAME VARCHAR(255),
EMPLNAME VARCHAR(255),
EMPLOYEETYPE VARCHAR(20),
SHIFTDATE DATE,
SHIFTTYPE VARCHAR(20)
);
CREATE TABLE CARS_DNORM (
REGISTRATIONNO CHAR(7) NOT NULL,
DRIVERID CHAR(9),
REGISTRATIONYEAR INTEGER,
MILEAGE VARCHAR(10),
LATESTMOTDATE DATE,
NOOFSEATS VARCHAR(10),
CARSTATUS VARCHAR(30),
OWNERID VARCHAR(9)
);
 
CREATE TABLE DRIVER_REVENUE_DNORM (
REVENUEID CHAR(9) NOT NULL,
DRIVERID CHAR(9),
REVENUEDATE DATE,
GROSSTAKINGS NUMBER(8,2),
PAIDTOCOMPANY NUMBER(8,2),
NETEARNINGS NUMBER(8,2)
);
 
CREATE TABLE EMPLOYEE_DNORM (
NINUMBER CHAR(9) NOT NULL,
ADDRESS VARCHAR2(255),
POSTCODE VARCHAR(20),
CITY VARCHAR(50),
FIRSTNAME VARCHAR(255),
LASTNAME VARCHAR(255),
PPHONENO CHAR(11),
SPHONENO CHAR(11),
SEX CHAR(1),
DOB DATE,
EMAIL VARCHAR2(255),
HIREDATE DATE,
DRIVERLICENSEID CHAR(9),
PAYTYPE VARCHAR(9),
PAYVALUE NUMBER(9),
SALARY NUMBER(8,2),
TAXCODE VARCHAR(20)
);
 
CREATE TABLE REGULAR_BOOKING_DNORM (
REGBOOKID CHAR(9) NOT NULL,
CLIENTID CHAR(9),
BOOKINGFREQUENCY VARCHAR(7),
STARTDATE DATE,
DURATION VARCHAR(10),
NOOFPASSENGERS  NUMBER(2)
);

CREATE TABLE CLIENTS_DNORM (
CLIENTID CHAR(9) NOT NULL,
CLIENTTYPE VARCHAR(15),
CONTACTFNAME VARCHAR(255),
CONTACTLNAME VARCHAR(255),
PPHONENO CHAR(11),
SPHONENO CHAR(11),
CORPERATIONNAME VARCHAR(50),
EMAIL VARCHAR2(400)
);
 
CREATE TABLE EMPLOYEE_INCIDENTS_DNORM (
INCIDENTID CHAR(9) NOT NULL,
NINUMBER CHAR(9),
INCIDENTTYPE VARCHAR2(20),
INCIDENTNOTES VARCHAR2(4000),
INCIDENTDATE DATE
);

/* INSERTS */

/* INSERT INTO BOOKING_DNORM VALUES ('BK0000001','EP0000001','EP0000002', NULL,NULL,TO_DATE('08-DEC-2019','DD-MON-YYYY'),TO_DATE('12-NOV-2020','DD-MON-YYYY'), 'PKUP 1 STREET EP CD1 LONDON','DRPOF 1 STREET EP CD1 LONDON',3,'07900000000', 'CASH', TO_DATE('11-NOV-2020','DD-MON-YYYY'), 'RAY', 'JAY', NULL, NULL, NULL, 50.05); */
INSERT INTO BOOKING_DNORM VALUES ('BK0000002','EP0000003','EP0000004', 'RB0000001','CL123456A',TO_DATE('07-DEC-2019','DD-MON-YYYY'),TO_DATE('11-NOV-2020','DD-MON-YYYY'), 'PKUP 2 STREET EP CD2 LONDON','DRPOF 2 STREET EP CD2 LONDON',5,'07900000001', 'CARD', TO_DATE('09-NOV-2020','DD-MON-YYYY'), 'BEN', 'KEN', '4444555566667777', TO_DATE('19-JAN-2025','DD-MON-YYYY'), '123', 40.66);
INSERT INTO BOOKING_DNORM VALUES ('BK0000003','EP0000005','EP0000006', 'RB0000003','CL123456B',TO_DATE('05-OCT-2018','DD-MON-YYYY'),TO_DATE('11-MAR-2019','DD-MON-YYYY'), 'PKUP 3 STREET EP CD3 LONDON','DRPOF 3 STREET EP CD3 CARDIFF',5,'07900000002', 'CARD',TO_DATE('05-OCT-2018','DD-MON-YYYY'), 'DAN', 'TAN', '1111555566667777', TO_DATE('19-JAN-2022','DD-MON-YYYY'), '130', 140);
INSERT INTO BOOKING_DNORM VALUES ('BK0000004','EP0000007','EP0000008', 'RB0000002','CL123456A',TO_DATE('08-AUG-2016','DD-MON-YYYY'),TO_DATE('02-JAN-2020','DD-MON-YYYY'), 'PKUP 4 STREET EP CD4 LONDON','DRPOF 4 STREET EP CD4 LONDON',1,'07900000003', 'CASH', TO_DATE('11-NOV-2020','DD-MON-YYYY'), 'AYA', 'YA', NULL, NULL, NULL, 6);

/* */

INSERT INTO REGULAR_BOOKING_DNORM VALUES ('RB000001','CL123456A','MONTHLY',TO_DATE('11-NOV-2020','DD-MON-YYYY'),'30 DAYS','50');
INSERT INTO REGULAR_BOOKING_DNORM VALUES ('RB000003','CL123456B','WEEKLY',TO_DATE('11-JAN-2011','DD-MON-YYYY'),'30 DAYS','2');
INSERT INTO REGULAR_BOOKING_DNORM VALUES ('RB000002','CL123456A','DAILY',TO_DATE('10-NOV-2020','DD-MON-YYYY'),'14 DAYS','4');

/* */

INSERT INTO SHIFT_DNORM VALUES ('SH123456A', 'EP123456A','Dan', 'Fcface', 'OPERATOR',TO_DATE('02-NOV-2020', 'DD-MON-YYYY'), 'MORNING');
INSERT INTO SHIFT_DNORM VALUES ('SH123456B', 'EP123456B', 'Ray', 'Rampatino', 'OPERATOR',TO_DATE('04-NOV-2020', 'DD-MON-YYYY'), 'AFTERNOON');
INSERT INTO SHIFT_DNORM VALUES ('SH123456C', 'EP123456C','Digby', 'Dadarino', 'DRIVER',TO_DATE('08-NOV-2020', 'DD-MON-YYYY'), 'NIGHT');
INSERT INTO SHIFT_DNORM VALUES ('SH123456D', 'EP123456D','Dan2', 'Fcface2', 'OPERATOR',TO_DATE('02-NOV-2020', 'DD-MON-YYYY'), 'MORNING');
INSERT INTO SHIFT_DNORM VALUES ('SH123456E', 'EP123456E', 'Ray2', 'Rampatino2', 'OPERATOR',TO_DATE('04-NOV-2020', 'DD-MON-YYYY'), 'AFTERNOON');
INSERT INTO SHIFT_DNORM VALUES ('SH123456F', 'EP123456F','Digby2', 'Dadarino2', 'DRIVER',TO_DATE('08-NOV-2020', 'DD-MON-YYYY'), 'MORNING');

/* */

INSERT INTO CARS_DNORM VALUES('CR1234A','DV123456A',2013,52041,TO_DATE('02-JAN-2020','DD-MON-YYYY'),4,'ROADWORTHY','COMPANY*');
INSERT INTO CARS_DNORM VALUES('CR1234B','DV123456B',2019,43214,TO_DATE('08-JUL-2020','DD-MON-YYYY'),7,'IN FOR SERVICE','DV123456B');
INSERT INTO CARS_DNORM VALUES('CR1234C','DV123456C',2018,23791,TO_DATE('02-MAY-2020','DD-MON-YYYY'),3,'ROADWORTHY','COMPANY*');

/* */

INSERT INTO DRIVER_REVENUE_DNORM VALUES ('RV123456A','DV123456A',TO_DATE('01-JUL-2020','DD-MON-YYYY'),3000,476,2524);
INSERT INTO DRIVER_REVENUE_DNORM VALUES ('RV123456B','DV123456B',TO_DATE('22-AUG-2020','DD-MON-YYYY'),2000,426,1574);
INSERT INTO DRIVER_REVENUE_DNORM VALUES ('RV123456C','DV123456C',TO_DATE('1-JUN-2020','DD-MON-YYYY'),3000,393,2607);

/* */

INSERT INTO EMPLOYEE_DNORM VALUES ('EP123456A','43 OCEANA CLOSE','N16 7GK','LONDON','FABIEN','GARNER','07000000028',NULL,'M',TO_DATE('05-AUG-1974','DD-MON-YYYY'),'EMAIL1@EMAIL.COM',TO_DATE('08-JAN-2020','DD-MON-YYYY'),'DV123456A','FIXEDFULL', 36000, NULL, NULL );
INSERT INTO EMPLOYEE_DNORM VALUES ('EP123456D','12 PARKLANE AVENUE','N2F 0FL','LONDON','BRYAN','NAISMITH','07000000025',NULL,'M',TO_DATE('03-MAY-1979','DD-MON-YYYY'),'EMAIL2@EMAIL.COM',TO_DATE('02-MAR-2020','DD-MON-YYYY'),NULL,NULL,NULL, 40000, '1250L' );
INSERT INTO EMPLOYEE_DNORM VALUES ('EP123456B','1 BERKIN STREET','B1 1DA','BIRMINGHAM','AMY','HALLOW','07000000023',NULL,'F',TO_DATE('31-MAY-1993','DD-MON-YYYY'),'EMAIL3@EMAIL.COM',TO_DATE('01-JUN-2020','DD-MON-YYYY'),'DV123456B','FIXEDTEMP', 24000, NULL, NULL );
INSERT INTO EMPLOYEE_DNORM VALUES ('EP123456C','7 LADBROKE GROVE','W11 8FS','LONDON','GARY','JOHNSON','07000000022',NULL,'M',TO_DATE('25-JUL-1992','DD-MON-YYYY'),'EMAIL4@EMAIL.COM',TO_DATE('05-NOV-2020','DD-MON-YYYY'),'DV123456C','FIXEDFULL', 36000, NULL, NULL );
INSERT INTO EMPLOYEE_DNORM VALUES ('EP123456D','7 LADBROKE GROVE','W11 8FS','LONDON','DARY','SON','07000000027',NULL,'M',TO_DATE('25-JUL-1992','DD-MON-YYYY'),'EMAIL4@EMAIL.COM',TO_DATE('05-NOV-2020','DD-MON-YYYY'),'DV123456C','FIXEDFULL', 36000, NULL, NULL );
INSERT INTO EMPLOYEE_DNORM VALUES ('EP123456E','7 LADBROKE GROVE','W11 8FS','LONDON','RARY','ROHNSON','07000000026',NULL,'M',TO_DATE('25-JUL-1992','DD-MON-YYYY'),'EMAIL4@EMAIL.COM',TO_DATE('05-NOV-2020','DD-MON-YYYY'),'DV123456C','FIXEDFULL', 36000, NULL, NULL );

/* */

INSERT INTO EMPLOYEE_INCIDENTS_DNORM VALUES ('IN123456A','EP123456A','SICK',NULL,TO_DATE('02-NOV-2020','DD-MON-YYYY'));
INSERT INTO EMPLOYEE_INCIDENTS_DNORM VALUES ('IN123456B','EP123456B','DISCIPLINARY ACTION','BROUGHT ILLEGAL SUBSTANCES INTO THE WORKPLACE',TO_DATE('06-NOV-2020','DD-MON-YYYY'));
INSERT INTO EMPLOYEE_INCIDENTS_DNORM VALUES ('IN123456C','EP123456C','VACATION REQUEST','I HEAR SPAIN IS A GREAT PLACE TO FIND CARS, MIND IF I TAKE A LOOK MYSELF?',TO_DATE('26-NOV-2020','DD-MON-YYYY'));

/* */

INSERT INTO CLIENTS_DNORM VALUES ('CL123456A','PRIVATE','ALPHONSO','ROGERS','07500000013','07500000098',NULL,'CLEMAIL1@EMAIL.COM');
INSERT INTO CLIENTS_DNORM VALUES ('CL123456B','CORPORATE','LIONEL','ALLAN','07500000012','07500000067','PATEK INDUSTRIES','CLEMAIL2@EMAIL.COM');
INSERT INTO CLIENTS_DNORM VALUES ('CL123456C','PRIVATE','JAMIE','DAVIES','07500000011','07500000021',NULL,'CLEMAIL3@EMAIL.COM');

/* BIG TABLES */

DROP TABLE REGULAR_BOOKING_DNORM_BIG;
DROP TABLE CLIENTS_DNORM_BIG;
DROP TABLE CARS_DNORM_BIG;
DROP TABLE DRIVER_REVENUE_DNORM_BIG;
DROP TABLE BOOKING_DNORM_BIG;
DROP TABLE EMPLOYEE_INCIDENTS_DNORM_BIG;
DROP TABLE SHIFT_DNORM_BIG;
DROP TABLE EMPLOYEE_DNORM_BIG;

CREATE TABLE REGULAR_BOOKING_DNORM_BIG AS SELECT * FROM REGULAR_BOOKING_DNORM;
CREATE TABLE CLIENTS_DNORM_BIG AS SELECT * FROM CLIENTS_DNORM;
CREATE TABLE CARS_DNORM_BIG AS SELECT * FROM CARS_DNORM;
CREATE TABLE DRIVER_REVENUE_DNORM_BIG AS SELECT * FROM DRIVER_REVENUE_DNORM;
CREATE TABLE BOOKING_DNORM_BIG AS SELECT * FROM BOOKING_DNORM;
CREATE TABLE EMPLOYEE_INCIDENTS_DNORM_BIG AS SELECT * FROM EMPLOYEE_INCIDENTS_DNORM;
CREATE TABLE SHIFT_DNORM_BIG AS SELECT * FROM SHIFT_DNORM;
CREATE TABLE EMPLOYEE_DNORM_BIG AS SELECT * FROM EMPLOYEE_DNORM;

/* INCREASE EXPONENTIALLY */

SET SERVEROUTPUT ON;

DECLARE
cntr NUMBER := 0;
BEGIN
    FOR loop_counter IN 1..13 /*17*/
LOOP
cntr := cntr  + 1;
INSERT INTO BOOKING_DNORM_BIG SELECT * FROM BOOKING_DNORM_BIG;
INSERT INTO REGULAR_BOOKING_DNORM_BIG SELECT * FROM REGULAR_BOOKING_DNORM_BIG;
INSERT INTO SHIFT_DNORM_BIG SELECT * FROM SHIFT_DNORM_BIG;
INSERT INTO CARS_DNORM_BIG SELECT * FROM CARS_DNORM_BIG;
INSERT INTO DRIVER_REVENUE_DNORM_BIG SELECT * FROM DRIVER_REVENUE_DNORM_BIG;
INSERT INTO EMPLOYEE_INCIDENTS_DNORM_BIG SELECT * FROM EMPLOYEE_INCIDENTS_DNORM_BIG;
INSERT INTO CLIENTS_DNORM_BIG SELECT * FROM CLIENTS_DNORM_BIG;
INSERT INTO EMPLOYEE_DNORM_BIG SELECT * FROM EMPLOYEE_DNORM_BIG;
END LOOP;
dbms_output.put_line('Executed: ' || cntr) ;
END;
/

/* TABLE COUNTS */

/*
SELECT COUNT(*) FROM BOOKING_DNORM;
SELECT COUNT(*) FROM REGULAR_BOOKING_DNORM;
SELECT COUNT(*) FROM SHIFT_DNORM;
SELECT COUNT(*) FROM CARS_DNORM;
SELECT COUNT(*) FROM DRIVER_REVENUE_DNORM;
SELECT COUNT(*) FROM EMPLOYEE_INCIDENTS_DNORM;
SELECT COUNT(*) FROM CLIENTS_DNORM;

SELECT COUNT(*) FROM BOOKING_DNORM_BIG;
SELECT COUNT(*) FROM REGULAR_BOOKING_DNORM_BIG;
SELECT COUNT(*) FROM SHIFT_DNORM_BIG;
SELECT COUNT(*) FROM CARS_DNORM_BIG;
SELECT COUNT(*) FROM DRIVER_REVENUE_DNORM_BIG;
SELECT COUNT(*) FROM EMPLOYEE_INCIDENTS_DNORM_BIG;
SELECT COUNT(*) FROM CLIENTS_DNORM_BIG;
*/

/* DROP STATEMENTS */ 
DROP TABLE RECURRENT_BOOKING;
DROP TABLE PAYMENT;
DROP TABLE CORPORATE_CLIENT;
DROP TABLE REGULAR_BOOKING;
DROP TABLE CLIENTS;
DROP TABLE CARS;
DROP TABLE DRIVER_REVENUE;
DROP TABLE BOOKING;
DROP TABLE DRIVER;
DROP TABLE PAY_TYPE;
DROP TABLE OPERATOR;
DROP TABLE EMPLOYEE_INCIDENTS;
DROP TABLE SHIFT;
DROP TABLE EMPLOYEE;
DROP TABLE CITY_LOOKUP;

/* CITY_LOOKUP Table */ 
CREATE TABLE CITY_LOOKUP(
POSTCODE VARCHAR(8) PRIMARY KEY,
CITY VARCHAR(50)
);

/* CLIENTS Table */ 
CREATE TABLE CLIENTS (
CLIENTID CHAR(9) PRIMARY KEY,
CLIENTTYPE VARCHAR(15),
CONTACTFNAME VARCHAR(255),
CONTACTLNAME VARCHAR(255),
PPHONENO CHAR(11),
SPHONENO CHAR(11),
EMAIL VARCHAR2(400)
);

/* PAY_TYPE Table */ 
CREATE TABLE PAY_TYPE (
PAYTYPE VARCHAR(9) PRIMARY KEY,
PAYVALUE NUMBER(9)   
);

/* EMPLOYEE Table */ 
CREATE TABLE EMPLOYEE(
NINUMBER CHAR(9) PRIMARY KEY, 
POSTCODE VARCHAR(20), 
ADDRESS VARCHAR2(255), 
FIRSTNAME VARCHAR(255), 
LASTNAME VARCHAR(255), 
PPHONENO CHAR(11),
SPHONENO CHAR(11),
SEX CHAR(1),
DOB DATE, 
EMAIL VARCHAR2(255), 
HIREDATE DATE
);

/* OPERATOR Table */ 
CREATE TABLE OPERATOR (
OPERATORID CHAR(9),
EMPLOYEEID CHAR(9),
SALARY NUMBER(8,2),
TAXCODE VARCHAR(20)
); 

/* DRIVER Table */ 
CREATE TABLE DRIVER (
DRIVERLICENSEID CHAR(9),
EMPLOYEEID CHAR(9),
PAYTYPE VARCHAR (9)
);

/* BOOKING Table */ 
CREATE TABLE BOOKING (
BOOKINGID CHAR(9) PRIMARY KEY,
OPERATORID CHAR(9),
DRIVERID CHAR(9),
DATEBOOKED DATE,
PICKUPDATE DATE,
PICKUPADDRESS VARCHAR(255),
DROPOFFADDRESS VARCHAR2(255),
NOOFPASSENGERS NUMBER(2),
CUSTOMERPHONENUMBER CHAR(11)
);

/* REGULAR_BOOKING Table */ 
CREATE TABLE REGULAR_BOOKING(
REGBOOKID CHAR(9) PRIMARY KEY,
CLIENTID CHAR(9),
BOOKINGFREQUENCY VARCHAR(50),
STARTDATE DATE,
NOOFTRANSPORTEES NUMBER(2),
DURATION VARCHAR(10)
);

/* DRIVER_REVENUE Table */ 
CREATE TABLE DRIVER_REVENUE(
REVENUEID CHAR(9) PRIMARY KEY,
DRIVERID CHAR(9),
REVENUEDATE DATE,
GROSSTAKINGS NUMBER(8,2),
PAIDTOCOMPANY NUMBER(8,2),
NETEARNINGS NUMBER(8,2)
);

/* CORPERATE_CLIENT Table */ 
CREATE TABLE CORPORATE_CLIENT (
CLIENTID CHAR(9) PRIMARY KEY,
CORPERATIONNAME VARCHAR(50)
);

/* EMPLOYEE_INCIDENTS Table */ 
CREATE TABLE EMPLOYEE_INCIDENTS (
INCIDENTID CHAR(9) PRIMARY KEY,
NINUMBER CHAR(9),
INCIDENTTYPE VARCHAR2(20),
INCIDENTNOTES VARCHAR2(4000),
INCIDENTDATE DATE
);

/* CARS Table */ 
CREATE TABLE CARS (
REGISTRATIONNO CHAR(7) PRIMARY KEY,
DRIVERID CHAR(9),
REGISTRATIONYEAR INTEGER,
MILEAGE VARCHAR(10),
LASTMOTDATE DATE,
NOOFSEATS VARCHAR(10),
CARSTATUS VARCHAR(30),
OWNERID VARCHAR(9)
);

/* SHIFT Table */ 
CREATE TABLE SHIFT (
SHIFTID CHAR(9) PRIMARY KEY,
EMPLOYEEID CHAR(9),
SHIFTDATE DATE,
SHIFTTYPE VARCHAR(20)
);

/* PAYMENT Table */ 
CREATE TABLE PAYMENT (
PAYMENTID CHAR(9) PRIMARY KEY,
BOOKINGID CHAR(9),
PAYMENTMETHOD VARCHAR(10),
PAYMENTDATE DATE,
PAYEESFIRSTNAME VARCHAR(255),
PAYEESLASTNAME VARCHAR(255),
CARDNUMBER VARCHAR(16),
EXPIRYDATE DATE,
CVV CHAR(3),
AMOUNTPAID NUMBER(8,2)
);

/* RECURRENT_BOOKING Table */ 
CREATE TABLE RECURRENT_BOOKING (
BOOKINGID CHAR(9),
REGBOOKID CHAR(9)
);
/* CITY_LOOKUP Inserts */ 
INSERT INTO CITY_LOOKUP VALUES ('N14 4AU', 'NORTH LONDON');
INSERT INTO CITY_LOOKUP VALUES ('NW8 9ZL', 'NORTH WEST LONDON');
INSERT INTO CITY_LOOKUP VALUES ('SW17 6AF', 'SOUTH WEST LONDON');

/* EMPLOYEE Inserts */ 
INSERT INTO EMPLOYEE VALUES ('EP123456A','B1 1DA','5 ALLINGTON ROAD','Dan', 'Fcface','07000000000',NULL,'M',TO_DATE('23-JAN-2002','DD-MON-YYYY'),'EMAIL1@EMAIL.COM',TO_DATE('06-NOV-2020','DD-MON-YYYY'));
INSERT INTO EMPLOYEE VALUES ('EP123456B','B1 1DA','44 ALLINGTON ROAD', 'Ray', 'Rampatino','07000000001','07000000002','M',TO_DATE('12-JAN-1998','DD-MON-YYYY'),'EMAIL2@EMAIL.COM',TO_DATE('18-MAY-2020','DD-MON-YYYY'));
INSERT INTO EMPLOYEE VALUES ('EP123456C','B1 1DA','39 ALLINGTON ROAD','Digby','Dadarino','07000000003',NULL,'M',TO_DATE('23-JAN-2002','DD-MON-YYYY'),'EMAIL3@EMAIL.COM',TO_DATE('06-NOV-2020','DD-MON-YYYY'));
INSERT INTO EMPLOYEE VALUES ('EP123456D','B1 1DA','60 ALLINGTON ROAD','Dan2','Fcface2','07000000004',NULL,'M',TO_DATE('12-FEB-2001','DD-MON-YYYY'),'EMAIL4@EMAIL.COM',TO_DATE('05-FEB-2020','DD-MON-YYYY'));
INSERT INTO EMPLOYEE VALUES ('EP123456E','B1 1DA','90 ALLINGTON ROAD','Ray2', 'Rampatino2','07000000005',NULL,'M',TO_DATE('12-JAN-1971','DD-MON-YYYY'),'EMAIL5@EMAIL.COM',TO_DATE('01-JUN-2020','DD-MON-YYYY'));
INSERT INTO EMPLOYEE VALUES ('EP123456F','N14 4AU','63 KEYSE ROAD','Digby2', 'Dadarino2','07000000006','07000000007','M',TO_DATE('16-OCT-1978','DD-MON-YYYY'),'EMAIL6@EMAIL.COM',TO_DATE('05-MAR-2020','DD-MON-YYYY'));

/* CLIENTS Inserts */ 
INSERT INTO CLIENTS VALUES ('CL123456A','PRIVATE','EDWARD','ELRIC','07500000000',NULL,'CLEMAIL1@EMAIL.COM');
INSERT INTO CLIENTS VALUES ('CL123456B','PRIVATE','HASHIRAMA','SENJU','07500000001',NULL,'CLEMAIL2@EMAIL.COM');
INSERT INTO CLIENTS VALUES ('CL123456C','PRIVATE','RINTAROU','OKABE','07500000002','07500000022','CLEMAIL3@EMAIL.COM');

/* PAY_TYPE Inserts */ 
INSERT INTO PAY_TYPE VALUES ('FIXEDTEMP', 24000);
INSERT INTO PAY_TYPE VALUES ('FIXEDFULL', 36000);
INSERT INTO PAY_TYPE VALUES ('COMM75', 75);

/* OPERATOR Inserts */ 
INSERT INTO OPERATOR VALUES('OP123456A','EP123456A',40000,'1250L');
INSERT INTO OPERATOR VALUES('OP123456B','EP123456B',42500,'1250L');
INSERT INTO OPERATOR VALUES('OP123456C','EP123456C',39000,'1250L');

/* DRIVER Inserts */ 
INSERT INTO DRIVER VALUES ('DV123456A','EP123456D','FIXEDFULL');
INSERT INTO DRIVER VALUES ('DV123456B','EP123456E','COMM75');
INSERT INTO DRIVER VALUES ('DV123456C','EP123456F','FIXEDFULL');

/* BOOKING Inserts */ 
INSERT INTO BOOKING VALUES ('BK0000002','OP123456A','DV123456A',TO_DATE('08-NOV-2020','DD-MON-YYYY'),TO_DATE('12-NOV-2020','DD-MON-YYYY'),'21 BALFE STREET','79 TEMPLE WAY',3,'07900000000');
INSERT INTO BOOKING VALUES ('BK0000003','OP123456B','DV123456B',TO_DATE('07-MAY-2020','DD-MON-YYYY'),TO_DATE('08-MAY-2020','DD-MON-YYYY'),'78 TRAILLE STREET','76 BOAR LANE',5,'07900000001');
INSERT INTO BOOKING VALUES ('BK0000004','OP123456C','DV123456C',TO_DATE('15-APR-2020','DD-MON-YYYY'),TO_DATE('15-APR-2020','DD-MON-YYYY'),'72 QUAY STREET','63 PRINCE CONSORT ROAD',5,'07900000002');

/* REGULAR_BOOKING Inserts */ 
INSERT INTO REGULAR_BOOKING VALUES ('RB0000001','CL123456A','WEEKLY',TO_DATE('02-NOV-2020','DD-MON-YYYY'),3,'7 WEEKS');
INSERT INTO REGULAR_BOOKING VALUES ('RB0000002','CL123456B','DAILY',TO_DATE('02-NOV-2020','DD-MON-YYYY'),5,'4 DAYS');
INSERT INTO REGULAR_BOOKING VALUES ('RB0000003','CL123456A','WEEKLY',TO_DATE('02-NOV-2020','DD-MON-YYYY'),5,'4 WEEKS');

/* DRIVER_REVENUE Inserts */ 
INSERT INTO DRIVER_REVENUE VALUES ('RV123456A','DV123456A',TO_DATE('01-NOV-2020','DD-MON-YYYY'),3000,476,2524);
INSERT INTO DRIVER_REVENUE VALUES ('RV123456B','DV123456B',TO_DATE('01-NOV-2020','DD-MON-YYYY'),2932,833,2099);
INSERT INTO DRIVER_REVENUE VALUES ('RV123456C','DV123456C',TO_DATE('01-NOV-2020','DD-MON-YYYY'),3000,497,2503);

/* CORPERATE_CLIENT Inserts */ 
INSERT INTO CORPORATE_CLIENT VALUES('CL123456A','UMBRELLA CORP');
INSERT INTO CORPORATE_CLIENT VALUES('CL123456B','WONKA INDUSTRIES');
INSERT INTO CORPORATE_CLIENT VALUES('CL123456C','STARK INDUSTRIES');

/* EMPLOYEE_INCIDENTS Inserts */ 
INSERT INTO EMPLOYEE_INCIDENTS VALUES ('IN123456A','EP123457A','SICK','GOT MY FINGERS STUCK IN A BOWLING BALL',TO_DATE('02-NOV-2020','DD-MON-YYYY'));
INSERT INTO EMPLOYEE_INCIDENTS VALUES ('IN123456B','EP123456B','VACATION REQUEST','I WANT TO GO ON MY HONEYMOON',TO_DATE('10-NOV-2020','DD-MON-YYYY'));
INSERT INTO EMPLOYEE_INCIDENTS VALUES ('IN123456C','EP123456C','DISCIPLINARY ACTION','CAME TO WORK DRUNK. LICENSE SUSPENDED UNTIL FURTHER NOTICE',TO_DATE('02-OCT-2020','DD-MON-YYYY'));
INSERT INTO CARS VALUES('CR1234A','DV123456A',2018,52041,TO_DATE('06-AUG-2020','DD-MON-YYYY'),4,'ROADWORTHY','COMPANY*');
INSERT INTO CARS VALUES('CR1234B','DV123456B',2008,112218,TO_DATE('28-AUG-2020','DD-MON-YYYY'),4,'AWAITING REPAIR','COMPANY*');
INSERT INTO CARS VALUES('CR1234C','DV123456C',2012,178627,TO_DATE('28-APR-2020','DD-MON-YYYY'),5,'ROADWORTHY','DV123456C');

/* SHIFT Inserts */ 
INSERT INTO SHIFT VALUES ('SH123456A','EP123456A',TO_DATE('05-NOV-2020','DD-MON-YYYY'),'MORNING');
INSERT INTO SHIFT VALUES ('SH123456B','EP123456B',TO_DATE('25-NOV-2020','DD-MON-YYYY'),'AFTERNOON');
INSERT INTO SHIFT VALUES ('SH123456C','EP123456C',TO_DATE('29-NOV-2020','DD-MON-YYYY'),'NIGHT');
INSERT INTO SHIFT VALUES ('SH123456D','EP123456D',TO_DATE('05-NOV-2020','DD-MON-YYYY'),'MORNING');
INSERT INTO SHIFT VALUES ('SH123456E','EP123456E',TO_DATE('13-NOV-2020','DD-MON-YYYY'),'AFTERNOON');
INSERT INTO SHIFT VALUES ('SH123456F','EP123456F',TO_DATE('08-NOV-2020','DD-MON-YYYY'),'MORNING');

/* PAYMENT Inserts */ 
INSERT INTO PAYMENT VALUES('PY123456A','BK0000002','CARD',TO_DATE('08-NOV-2020','DD-MON-YYYY'),'KAZUTO','KIRIGAYA','4432491216876558',TO_DATE('AUG-2023','MON-YYYY'),'296',40.66);
INSERT INTO PAYMENT VALUES('PY123456B','BK0000003','CARD',TO_DATE('07-MAY-2020','DD-MON-YYYY'),'KURISU','MAKISE','5127071833675349',TO_DATE('AUG-2023','MON-YYYY'),'314',140);
INSERT INTO PAYMENT VALUES('PY123456C','BK0000004','CARD',TO_DATE('15-APR-2020','DD-MON-YYYY'),'HACHIMAN','HIKIGAYA','5213211675421049',TO_DATE('AUG-2023','MON-YYYY'),'329',6);

/* RECURRENT_BOOKING Inserts */ 
INSERT INTO RECURRENT_BOOKING VALUES('BK0000002','RB0000001');
INSERT INTO RECURRENT_BOOKING VALUES('BK0000003','RB0000002');
INSERT INTO RECURRENT_BOOKING VALUES('BK0000004','RB0000003');



/* BIG TABLES (Normalized) */
DROP TABLE REGULAR_BOOKING_BIG;
DROP TABLE CLIENTS_BIG;
DROP TABLE CARS_BIG;
DROP TABLE DRIVER_REVENUE_BIG;
DROP TABLE BOOKING_BIG;
DROP TABLE EMPLOYEE_INCIDENTS_BIG;
DROP TABLE SHIFT_BIG;
DROP TABLE EMPLOYEE_BIG;

DROP TABLE RECURRENT_BOOKING_BIG;
DROP TABLE PAY_TYPE_BIG;
DROP TABLE DRIVER_BIG;
DROP TABLE OPERATOR_BIG;
DROP TABLE  CITY_LOOKUP_BIG;
DROP TABLE CORPORATE_CLIENT_BIG;
DROP TABLE PAYMENT_BIG;

CREATE TABLE REGULAR_BOOKING_BIG AS SELECT * FROM REGULAR_BOOKING;
CREATE TABLE CLIENTS_BIG AS SELECT * FROM CLIENTS;
CREATE TABLE CARS_BIG AS SELECT * FROM CARS;
CREATE TABLE DRIVER_REVENUE_BIG AS SELECT * FROM DRIVER_REVENUE;
CREATE TABLE BOOKING_BIG AS SELECT * FROM BOOKING;
CREATE TABLE EMPLOYEE_INCIDENTS_BIG AS SELECT * FROM EMPLOYEE_INCIDENTS;
CREATE TABLE SHIFT_BIG AS SELECT * FROM SHIFT;
CREATE TABLE EMPLOYEE_BIG AS SELECT * FROM EMPLOYEE;

CREATE TABLE RECURRENT_BOOKING_BIG AS SELECT * FROM RECURRENT_BOOKING;
CREATE TABLE PAY_TYPE_BIG AS SELECT * FROM PAY_TYPE;
CREATE TABLE DRIVER_BIG AS SELECT * FROM DRIVER;
CREATE TABLE OPERATOR_BIG AS SELECT * FROM OPERATOR;
CREATE TABLE CITY_LOOKUP_BIG AS SELECT * FROM CITY_LOOKUP;
CREATE TABLE CORPORATE_CLIENT_BIG AS SELECT * FROM CORPORATE_CLIENT;
CREATE TABLE PAYMENT_BIG AS SELECT * FROM PAYMENT;

/* INCREASE EXPONENTIALLY (Normalized) */

SET SERVEROUTPUT ON;

DECLARE
cntr NUMBER := 0;
BEGIN
    FOR loop_counter IN 1..13 /*17*/
LOOP
cntr := cntr  + 1;
INSERT INTO BOOKING_BIG SELECT * FROM BOOKING_BIG;
INSERT INTO REGULAR_BOOKING_BIG SELECT * FROM REGULAR_BOOKING_BIG;
INSERT INTO SHIFT_BIG SELECT * FROM SHIFT_BIG;
INSERT INTO CARS_BIG SELECT * FROM CARS_BIG;
INSERT INTO DRIVER_REVENUE_BIG SELECT * FROM DRIVER_REVENUE_BIG;
INSERT INTO EMPLOYEE_INCIDENTS_BIG SELECT * FROM EMPLOYEE_INCIDENTS_BIG;
INSERT INTO CLIENTS_BIG SELECT * FROM CLIENTS_BIG;

INSERT INTO RECURRENT_BOOKING_BIG SELECT * FROM RECURRENT_BOOKING_BIG;
INSERT INTO PAY_TYPE_BIG SELECT * FROM PAY_TYPE_BIG ;
INSERT INTO DRIVER_BIG SELECT * FROM DRIVER_BIG;
INSERT INTO CITY_LOOKUP_BIG SELECT * FROM CITY_LOOKUP_BIG;
INSERT INTO CORPORATE_CLIENT_BIG SELECT * FROM CORPORATE_CLIENT_BIG;
INSERT INTO OPERATOR_BIG  SELECT * FROM OPERATOR_BIG;
INSERT INTO PAYMENT_BIG SELECT * FROM PAYMENT_BIG;
INSERT INTO EMPLOYEE_BIG SELECT * FROM EMPLOYEE_BIG;

END LOOP;
dbms_output.put_line('Executed: ' || cntr) ;
END;
/

SET TIMING ON
